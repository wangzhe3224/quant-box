<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Serverless Data Pipeline - SEC Insider Trades (Form 4) - QuantBox</title><meta name=Description content="Demo how to build a data processing pipeline with serverless on aws."><meta property="og:title" content="Serverless Data Pipeline - SEC Insider Trades (Form 4)"><meta property="og:description" content="Demo how to build a data processing pipeline with serverless on aws."><meta property="og:type" content="article"><meta property="og:url" content="https://quant.funcoder.net/posts/insider_trade_pipeline/"><meta property="og:image" content="https://quant.funcoder.net/posts/insider_trade_pipeline/header.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-17T00:00:00+00:00"><meta property="article:modified_time" content="2023-02-17T16:59:42+00:00"><meta property="og:site_name" content="QuantBox"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://quant.funcoder.net/posts/insider_trade_pipeline/header.png"><meta name=twitter:title content="Serverless Data Pipeline - SEC Insider Trades (Form 4)"><meta name=twitter:description content="Demo how to build a data processing pipeline with serverless on aws."><meta name=application-name content="Quant Box - 你的量化工具箱"><meta name=apple-mobile-web-app-title content="Quant Box - 你的量化工具箱"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://quant.funcoder.net/posts/insider_trade_pipeline/><link rel=prev href=https://quant.funcoder.net/posts/serverless-7-dynamodb/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Serverless Data Pipeline - SEC Insider Trades (Form 4)","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/quant.funcoder.net\/posts\/insider_trade_pipeline\/"},"image":[{"@type":"ImageObject","url":"https:\/\/quant.funcoder.net\/posts\/insider_trade_pipeline\/header.png","width":1746,"height":1184}],"genre":"posts","keywords":"aws, serverless, alternative-data, stds","wordcount":1760,"url":"https:\/\/quant.funcoder.net\/posts\/insider_trade_pipeline\/","datePublished":"2023-02-17T00:00:00+00:00","dateModified":"2023-02-17T16:59:42+00:00","publisher":{"@type":"Organization","name":"QuantBox","logo":{"@type":"ImageObject","url":"https:\/\/quant.funcoder.net\/images\/logo.png","width":1022,"height":984}},"author":{"@type":"Person","name":"FunCoder"},"description":"Demo how to build a data processing pipeline with serverless on aws."}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9801985319378542" crossorigin=anonymous></script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=QuantBox>QuantBox</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=https://github.com/wangzhe3224/quant-box title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="menu-item language" title="Select Language"><i class="fa fa-globe" aria-hidden=true></i>
<select class=language-select id=language-select-desktop onchange="location=this.value"><option value=/posts/insider_trade_pipeline/ selected>English</option></select></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=QuantBox>QuantBox</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=https://github.com/wangzhe3224/quant-box title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class=menu-item title="Select Language"><i class="fa fa-globe fa-fw" aria-hidden=true></i>
<select class=language-select onchange="location=this.value"><option value=/posts/insider_trade_pipeline/ selected>English</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Serverless Data Pipeline - SEC Insider Trades (Form 4)</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/wangzhe3224 title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>FunCoder</a></span>&nbsp;<span class=post-category>included in <a href=/categories/data-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Data Engineering</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-02-17>2023-02-17</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1760 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;9 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/posts/insider_trade_pipeline/header.png data-srcset="/posts/insider_trade_pipeline/header.png, /posts/insider_trade_pipeline/header.png 1.5x, /posts/insider_trade_pipeline/header.png 2x" data-sizes=auto alt=/posts/insider_trade_pipeline/header.png title="Demo how to build a data processing pipeline with serverless on aws."></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#design-decisions>Design Decisions</a><ul><li><a href=#how-the-pipeline-scales>How the Pipeline Scales</a></li><li><a href=#serverless-data-pipeline>Serverless Data Pipeline</a></li><li><a href=#parallelization>Parallelization</a></li><li><a href=#sql-or-nosql-or-s3>SQL or NoSQL or S3</a></li><li><a href=#error-handling>Error Handling</a></li><li><a href=#notification>Notification</a></li></ul></li><li><a href=#implementation>Implementation</a></li><li><a href=#summary>Summary</a></li></ul></nav></div></div><div class=content id=content><h2 id=introduction>Introduction</h2><p>In this post we will demo the design of a serverless data pipeline with aws using SEC
Insider Trade (Form 4) data as an example, which is <a href=https://www.sec.gov/dera/data/form-345 target=_blank rel="noopener noreffer">public available</a>.</p><p>This post is part of the implementation of <a href=https://quant.funcoder.net/tags/stds/ target=_blank rel="noopener noreffer">Systematic Trading Done Serverless Series</a>.</p><p>Securities and Exchange Commission, SEC, is a government agency mainly to enforce
law against security market manipulation<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><p>With Form 4 filing, the public is made aware of the insider’s various
transactions in company securities, including the amount purchased or sold and
the price per share. An “insider” is an officer, director, 10% stockholder and anyone who possesses inside information because of his or her relationship with the Company or with an officer, director or principal stockholder of the Company.</p><p>Form 4 must be filed within two business days following the
transaction date. More details <a href=https://www.sec.gov/files/forms-3-4-5.pdf target=_blank rel="noopener noreffer">check here</a>.</p><p>The form is delivered as XML file, for example <a href=https://www.sec.gov/Archives/edgar/data/320193/000032019323000022/0000320193-23-000022.txt target=_blank rel="noopener noreffer">a form 4 for AAPL</a> and here is the <a href=https://www.sec.gov/Archives/edgar/data/320193/000032019323000022/xslF345X03/wf-form4_167546747536649.xml target=_blank rel="noopener noreffer">same from in HTML format</a>. Screenshot as below<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217110125.png data-srcset="https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217110125.png, https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217110125.png 1.5x, https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217110125.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217110125.png title=20230217110125></p><p>Basically, Form 4 discloses insider&rsquo;s transactions of the company stocks or derivatives.
The information we care is that:</p><ul><li>Who traded, i.e. is he/she a director or officer or 10% owner?</li><li>How many shares at what price?</li><li>When traded, When reported?</li><li>Transaction type: directly trade? Option exercise?</li><li>Buy or Sell?</li></ul><p><strong>The goal is</strong>: give a universe of companies (identified by SEC id <code>CIK</code>), check
if there are any new Form 4 filings uploaded, if so download the XML files and
extract the insider trade information, then persist them for later usage. It would
also be good that we can get some form of notification if new insider trade happened.</p><h2 id=design-decisions>Design Decisions</h2><p>Here we break the design decision to following parts:</p><ul><li>Decision 1: How will the system scale up?</li><li>Decision 2: Pick up tools from each categories of the services</li><li>Decision 3: Use queue and lambda to achieve parallelization</li><li>Decision 4: What kind of storage should we use to store information</li><li>Decision 5: Design error path as normal path, let exception throw loudly</li></ul><p>Here is a diagram of the design in high level:</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217153607.png title=20230217153607 data-thumbnail=https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217153607.png data-sub-html="<h2>High Level Design</h2><p>20230217153607</p>"><img class=lazyload src=/svg/loading.min.svg data-src=https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217153607.png data-srcset="https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217153607.png, https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217153607.png 1.5x, https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217153607.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217153607.png></a><figcaption class=image-caption>High Level Design</figcaption></figure></p><p>Let&rsquo;s break it down.</p><h3 id=how-the-pipeline-scales>How the Pipeline Scales</h3><blockquote><p>Decision 1: Following id based parallelization patterns.</p></blockquote><p>In systematic trading world, nearly every predictor/signal starts with a data
pipeline. Most of the data pipelines are name by name basis, meaning given a
company or entity, there are multiple fields related to it.</p><p>For example, Apple Inc., we have price data, order book data, fundamental data,
alternative data such as social media, search activity, event data.</p><p>As we can see there are two dimensions about the data: identifier and field.
It is not entirely true, we also have a time dimension!</p><ul><li>id, <code>N</code></li><li>field, <code>F</code></li><li>time, <code>T</code></li></ul><p>The next question to ask is: in which dimension we process the data? The objective
function is speed, ie how can we process the data in the fastest way? <strong>I think the
answer drills down to how well we parallelize our data pipeline</strong>.</p><p>We can parallelize by id, by field, or event by time! Which one should we choose?
It depends on which one is larger and more uniform. Time is not a good choice in
my opinion as time is not even for all the ids and fields. And most of the time,
the number of ids, <code>N</code>, is much larger than the number of fields, <code>F</code>. In this
case, it is better to build the data pipeline by id basis, so that we gain the
most ability to parallelize.</p><p>In the end, the decision is we use company names as our parallelization path.</p><h3 id=serverless-data-pipeline>Serverless Data Pipeline</h3><blockquote><p>Decision 2: Pick up tools from each categories of the services</p></blockquote><p>In the <a href=https://quant.funcoder.net/tags/stds/ target=_blank rel="noopener noreffer">previous posts</a>, we went through quite a few serverless tools.
How to build data pipeline with to serverless tools?
As I proposed before, in serverless land, we think in three components, computation, communication, adn storage:</p><ul><li>Computation<ul><li>Lambda, for io requests, parsing the file and extracting information</li></ul></li><li>Communication<ul><li>EventBridge, for scheduling</li><li>SQS, for task management</li></ul></li><li>Storage<ul><li>S3, for file storage</li><li>DynamoDB, for post-processed data query</li></ul></li></ul><h3 id=parallelization>Parallelization</h3><blockquote><p>Decision 3: Use queue and lambda to achieve parallelization</p></blockquote><p>Since companies filings are independent, we can parallelize the pipeline very
well using lambda and queue.</p><p>This is a common design pattern in serverless land, namely <code>queue-lambda</code>.</p><p>The idea is the have a daily scheduled job kick off to enqueue all company names,
ie the universe we care. After all the jobs are in the queue, we define a lambda
function to check and download filing files if any. The benefit of lambda is that
we can nearly parallelize every names.</p><p>The benefit of a <code>queue-lambda</code> structure is that we can control our parallelization
via lambda&rsquo;s reserved concurrency. For example, if we set the reserved concurrency to
10, we will not processing more than 10 names at the same time.</p><p>There is another subtile yet interesting benefit of lambda: <strong>every code start lambda instance has a different public IP address</strong>!
This is really a great feature in terms scaping type data pipeline.
As we probably all know that most of the public available data source have some
sort of throttling control. Say for example the SEC website has a rate limit of 10 requests per second.
With the different lambda instance with different IPs, we actually increase the limit!</p><p>(please&mldr; don&rsquo;t do anything bad with this &mldr;.)</p><p>I did some experiments to prove this, here is the calling history of a lambda function.
The function is easy simply print its IP address:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>    @2023-02-01 20:00 {&#34;ip&#34;: &#34;18.170.55.26&#34;}
</span></span><span class=line><span class=cl>    @2023-02-01 23:30 {&#34;ip&#34;: &#34;18.169.190.4&#34;}
</span></span><span class=line><span class=cl>    @2023-02-01 23:48 {&#34;ip&#34;: &#34;18.134.99.111&#34;}
</span></span><span class=line><span class=cl>    @2023-02-02 11:17 {&#34;ip&#34;: &#34;3.8.162.74&#34;}
</span></span><span class=line><span class=cl>    @2023-02-02 20:39 {&#34;ip&#34;: &#34;18.168.205.156&#34;}
</span></span><span class=line><span class=cl>    @2023-02-02 22:04 {&#34;ip&#34;: &#34;13.42.48.110&#34;}
</span></span></code></pre></div><p>It turns out, we can get quite a few of public IP address for free with lambda.</p><h3 id=sql-or-nosql-or-s3>SQL or NoSQL or S3</h3><blockquote><p>Decision 4: What kind of storage should we use to store information</p></blockquote><p>In this pipeline, there are two pieces of information I would like to keep:
the raw Form 4 and processed Form 4.
Raw data is just the file we download from SEC website.
The processed data is bit more interesting. I only picked following fields:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;owner&#34;</span><span class=p>:</span> <span class=n>owner</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;cik&#34;</span><span class=p>:</span> <span class=n>cik</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=n>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;symbol&#34;</span><span class=p>:</span> <span class=n>symbol</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;tx_date&#34;</span><span class=p>:</span> <span class=n>tx_date</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;tx_code&#34;</span><span class=p>:</span> <span class=n>tx_code</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;tx_side&#34;</span><span class=p>:</span> <span class=n>tx_side</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;tx_shares&#34;</span><span class=p>:</span> <span class=n>tx_shares</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;post_tx_amount&#34;</span><span class=p>:</span> <span class=n>post_tx_amount</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;access_number&#34;</span><span class=p>:</span> <span class=n>access_number</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;filing_date&#34;</span><span class=p>:</span> <span class=n>filing_date</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></div><p>As long as we persist the raw data files, it is always possible to add another
downstream jobs to produced another set of post-process information.</p><p>Next question is: where shall we store the data?</p><h4 id=raw-data>Raw Data</h4><p>For the raw data, it is obvious that S3 is the place to go! The interesting
part is how can we design the folder and file name.</p><p>I proposed following: <code>{BUCKET}/{CIK}/{From}/{FilingDate}#{AccessNumber}.txt</code>.</p><p>Although this pipeline only focus on Form 4, I still add a sub path {From} to identify
potential more filing forms in the future.</p><h4 id=processed-data>Processed Data</h4><p>Processed data is almost like a dict in Python, it is highly structured (more structural then XML? Not sure.).
And it is a timeseries data by nature.</p><p>We have few options here: S3, DynamoDB (No-SQL), and SQL.</p><p>S3 seems not very good as lack of query abilities out of box. We could use is as a
underlying file system and build a query layer on top, but it sounds to much and
we have better options.</p><p>I indeed hesitate about DynamoBD and SQL (Serverless version AWS RDS - A relational database).
For DynamoDB is THE goto serverless database on aws, it is highly scalable and easy to setup.
The tricky bit is the primary key and secondary index design, see <a href=https://quant.funcoder.net/posts/serverless-7-dynamodb/ target=_blank rel="noopener noreffer">details</a>.</p><p>On the other hand, RDS a SQL database can never go wrong, right?? Tables, Primary key, foreign key,
on top all of these, we have powerful query planner, we can do all sort of join, aggregation on the fly.</p><p>Let&rsquo;s have a look at our data again. It is simple, a key value pair. Let&rsquo;s say we have 2000 names, 1 files per day.
The amount of the data is still very small. Both DynamoDB and RDS fit our purpose.
How to select?</p><p>The answer is a bit surprise: <strong>cost</strong>.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217163742.png data-srcset="https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217163742.png, https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217163742.png 1.5x, https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217163742.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/wangzhe3224/pic_repo/master/images/20230217163742.png title=20230217163742></p><p>With our data, DynamoDB is FREE to use.</p><p>So the decision is DynamoDB!</p><h3 id=error-handling>Error Handling</h3><blockquote><p>Decision 5: Design error path as normal path, let exception throw loudly</p></blockquote><p>In our data pipeline there are two potential failure points:</p><ul><li>Filing download job</li><li>Filing processing job</li></ul><p>The download job is a web io job, it could fail for all sort of reasons, limit cap, network error, etc.
The processing job could fail as well, for example, a change XML structure could just fail our parser.</p><p>We have to things to handle failures: retry and dead-letter queue.</p><p>We could config lambda function to retry 2 time, after all of them failed, the job
will be pushed into a dead-letter queue, which will trigger downstream notification
to alert the failures.</p><h3 id=notification>Notification</h3><p>Notification on aws is SNS. There are two types of notifications: on purpose and on failures.</p><p>In this design, we use DynamoDB stream to publish topics to SNS for on purpose notification.
Whereas, on failures notification is done with a lambda consume dead-letter queue items, then
publish to a failure topic in SNS.</p><h2 id=implementation>Implementation</h2><p>Ah wow, it takes some time to reach this point: implementation!
Given this post becomes too long to read (I am trying to limit each post under 2000 words),
I will leave the details with next post.</p><p>Some key points to encourage you keep an eye:</p><ul><li>How to develop serverless data pipeline with AWS SAM?</li><li>How to design the dynamoDB primary key for processed data?</li><li>How to set batch behavior for queue and lambda?</li><li>How S3 can trigger a lambda worker?</li><li>How to handle reentry of the lambda function?</li><li>How to avoid duplicated jobs? (as we know standard SQS is at least once delivery not exact once delivery)</li></ul><p>I am also working to release the source code for the implementation as well.</p><h2 id=summary>Summary</h2><p>In this post, we went through the design process of a serverless data pipeline.
The example dataset is SEC Insider Trader filing form 4.</p><p>We discussed varies design decisions, such as scalability, parallelization, storage, and error handling.</p><p>Interestingly, some time cost is also a design perspective in serverless. For
example, for this design, if we run about 505 names, it is almost free!</p><p>After the SNS topic of filing topic update, we could develop other downstream jobs, for example computing a signal based on insider trade event.
Or some aggregation job to transform the post-processed results to other easy to use format.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://www.investopedia.com/terms/s/sec.asp target=_blank rel="noopener noreffer">https://www.investopedia.com/terms/s/sec.asp</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href="https://www.sec.gov/edgar/browse/?CIK=320193&owner=exclude" target=_blank rel="noopener noreffer">https://www.sec.gov/edgar/browse/?CIK=320193&owner=exclude</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-02-17&nbsp;<a class=git-hash href=https://github.com/wangzhe3224/quant-box/commit/aab5dcc46ffb1fd3eb355fca71ccacbe85c18eaf target=_blank title="commit by Zhe Wang(wangzhetju@gmail.com) aab5dcc46ffb1fd3eb355fca71ccacbe85c18eaf: sec form 4 insider trade">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>aab5dcc</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://quant.funcoder.net/posts/insider_trade_pipeline/ data-title="Serverless Data Pipeline - SEC Insider Trades (Form 4)" data-hashtags=aws,serverless,alternative-data,stds><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://quant.funcoder.net/posts/insider_trade_pipeline/ data-hashtag=aws><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://quant.funcoder.net/posts/insider_trade_pipeline/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://quant.funcoder.net/posts/insider_trade_pipeline/ data-title="Serverless Data Pipeline - SEC Insider Trades (Form 4)" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://quant.funcoder.net/posts/insider_trade_pipeline/ data-title="Serverless Data Pipeline - SEC Insider Trades (Form 4)"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/aws/>aws</a>,&nbsp;<a href=/tags/serverless/>serverless</a>,&nbsp;<a href=/tags/alternative-data/>alternative-data</a>,&nbsp;<a href=/tags/stds/>stds</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/serverless-7-dynamodb/ class=prev rel=prev title="Systematic Trading Done Serverless (7) - DynamoDB"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Systematic Trading Done Serverless (7) - DynamoDB</a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><a href=https://github.com/sponsors/wangzhe3224>>> Sponsor Me <<</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://github.com/wangzhe3224 target=_blank>FunCoder</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://QuantBox.disqus.com/embed.js defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0,search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9229ZLLPT3",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-9229ZLLPT3" async></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9801985319378542" crossorigin=anonymous></script></body></html>